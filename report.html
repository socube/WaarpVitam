<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.8.1 from src/site/apt/index.apt at 2019-10-10 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Waarp Vitam Ingest &#x2013; </title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta http-equiv="Content-Language" content="en" />
    
  </head>
  <body class="composite">
    <div id="banner">
<a href="http://www.waarp.fr" id="bannerLeft"><img src="images/waarp.jpg"  alt="Waarp Project"/></a>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2019-10-10</span>
          &nbsp;| <span id="projectVersion">Version: 1.0.0</span>
      </div>
      <div class="xright"><a href="http://www.waarp.fr/" class="externalLink" title="Waarp">Waarp</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Waarp All</h5>
    <ul>
     <li class="none"><strong>Overview of Waarp All Server</strong></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="expanded"><a href="project-info.html" title="Project Information">Project Information</a>
      <ul>
       <li class="none"><strong>About</strong></li>
       <li class="none"><a href="summary.html" title="Summary">Summary</a></li>
       <li class="none"><a href="dependencies.html" title="Dependencies">Dependencies</a></li>
       <li class="none"><a href="dependency-convergence.html" title="Dependency Convergence">Dependency Convergence</a></li>
       <li class="none"><a href="dependency-info.html" title="Dependency Information">Dependency Information</a></li>
       <li class="none"><a href="dependency-management.html" title="Dependency Management">Dependency Management</a></li>
       <li class="none"><a href="issue-management.html" title="Issue Management">Issue Management</a></li>
       <li class="none"><a href="licenses.html" title="Licenses">Licenses</a></li>
       <li class="none"><a href="team.html" title="Team">Team</a></li>
       <li class="none"><a href="plugins.html" title="Plugins">Plugins</a></li>
       <li class="none"><a href="plugin-management.html" title="Plugin Management">Plugin Management</a></li>
       <li class="none"><a href="scm.html" title="Source Code Management">Source Code Management</a></li>
      </ul></li>
     <li class="collapsed"><a href="project-reports.html" title="Project Reports">Project Reports</a></li>
    </ul>
      <a href="https://www.waarp.fr/" title="Waarp" class="poweredBy">
        <img class="poweredBy"  alt="Waarp" src="https://www.waarp.fr/i/logo.png"     />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<div class="section">

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;border-color:#9ABAD9;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#9ABAD9;color:#444;background-color:#EBF5FF;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#9ABAD9;color:#fff;background-color:#409cff;}
.tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}
</style>

<h1 id="code-analysis">Code analysis</h1>
<h2 id="waarp-vitam-module">Waarp Vitam Module</h2>
<h4 id="version-1-0-0">Version 1.0.0</h4>
<p><strong>By: Frédéric Brégier</strong></p>
<p><em>Date: 2019-10-10</em></p>
<h2 id="introduction">Introduction</h2>
<p>This document contains results of the code analysis of Waarp Vitam Module</p>
<p>Waarp integration for Vitam, for Ingest (upload) of SIP and for
    export of DIP</p>
<h2 id="synthesis">Synthesis</h2>
<table class="tg">
<thead>
<tr>
<th class="tg-0pky" style="text-align:center">Quality Gate</th>
<th class="tg-0pky" style="text-align:center">Reliability</th>
<th class="tg-0pky" style="text-align:center">Security</th>
<th class="tg-0pky" style="text-align:center">Maintainability</th>
<th class="tg-0pky" style="text-align:center">Coverage</th>
<th class="tg-0pky" style="text-align:center">Duplications</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tg-0pky" style="text-align:center">WARNING</td>
<td class="tg-0pky" style="text-align:center">A</td>
<td class="tg-0pky" style="text-align:center">A</td>
<td class="tg-0pky" style="text-align:center">A</td>
<td class="tg-0pky" style="text-align:center">68.6 %</td>
<td class="tg-0pky" style="text-align:center">2.1 %</td>
</tr>
</tbody>
</table>
<h2 id="metrics">Metrics</h2>
<table class="tg">
<thead>
<tr>
<th class="tg-0pky" style="text-align:left">\</th>
<th class="tg-0pky" style="text-align:center">Cyclomatic Complexity</th>
<th class="tg-0pky" style="text-align:center">Cognitive Complexity</th>
<th class="tg-0pky" style="text-align:center">Lines of code per file</th>
<th class="tg-0pky" style="text-align:center">Coverage</th>
<th class="tg-0pky" style="text-align:center">Comment density (%)</th>
<th class="tg-0pky" style="text-align:center">Duplication (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tg-0pky" style="text-align:left">Min</td>
<td class="tg-0pky" style="text-align:center">0.0</td>
<td class="tg-0pky" style="text-align:center">0.0</td>
<td class="tg-0pky" style="text-align:center">1.0</td>
<td class="tg-0pky" style="text-align:center">0.0</td>
<td class="tg-0pky" style="text-align:center">4.4</td>
<td class="tg-0pky" style="text-align:center">0.0</td>
</tr>
<tr>
<td class="tg-0pky" style="text-align:left">Max</td>
<td class="tg-0pky" style="text-align:center">387.0</td>
<td class="tg-0pky" style="text-align:center">312.0</td>
<td class="tg-0pky" style="text-align:center">3150.0</td>
<td class="tg-0pky" style="text-align:center">87.5</td>
<td class="tg-0pky" style="text-align:center">98.5</td>
<td class="tg-0pky" style="text-align:center">13.2</td>
</tr>
</tbody>
</table>
<h2 id="volume">Volume</h2>
<table class="tg">
<thead>
<tr>
<th class="tg-0pky">Language</th>
<th class="tg-0pky">Number</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tg-0pky">Java</td>
<td class="tg-0pky">3150</td>
</tr>
<tr>
<td class="tg-0pky">Total</td>
<td class="tg-0pky">3150</td>
</tr>
</tbody>
</table>
<h2 id="issues-count-by-severity-and-types">Issues count by severity and types</h2>
<table class="tg">
<thead>
<tr>
<th class="tg-0pky">Type</th>
<th class="tg-0pky">Severity</th>
<th class="tg-0pky">Number</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tg-0pky">VULNERABILITY</td>
<td class="tg-0pky">BLOCKER</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">VULNERABILITY</td>
<td class="tg-0pky">CRITICAL</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">VULNERABILITY</td>
<td class="tg-0pky">MAJOR</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">VULNERABILITY</td>
<td class="tg-0pky">MINOR</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">VULNERABILITY</td>
<td class="tg-0pky">INFO</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">BUG</td>
<td class="tg-0pky">BLOCKER</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">BUG</td>
<td class="tg-0pky">CRITICAL</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">BUG</td>
<td class="tg-0pky">MAJOR</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">BUG</td>
<td class="tg-0pky">MINOR</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">BUG</td>
<td class="tg-0pky">INFO</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">BLOCKER</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">CRITICAL</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MAJOR</td>
<td class="tg-0pky">13</td>
</tr>
<tr>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MINOR</td>
<td class="tg-0pky">6</td>
</tr>
<tr>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">INFO</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">SECURITY_HOTSPOT</td>
<td class="tg-0pky">BLOCKER</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">SECURITY_HOTSPOT</td>
<td class="tg-0pky">CRITICAL</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">SECURITY_HOTSPOT</td>
<td class="tg-0pky">MAJOR</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">SECURITY_HOTSPOT</td>
<td class="tg-0pky">MINOR</td>
<td class="tg-0pky">0</td>
</tr>
<tr>
<td class="tg-0pky">SECURITY_HOTSPOT</td>
<td class="tg-0pky">INFO</td>
<td class="tg-0pky">0</td>
</tr>
</tbody>
</table>
<h2 id="issues">Issues</h2>
<table class="tg">
<thead>
<tr>
<th class="tg-0pky">Name</th>
<th class="tg-0pky">Description</th>
<th class="tg-0pky">Type</th>
<th class="tg-0pky">Severity</th>
<th class="tg-0pky">Number</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tg-0pky">Source files should not have any duplicated blocks</td>
<td class="tg-0pky">An issue is created on a file as soon as there is at least one block of duplicated code on this file</td>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MAJOR</td>
<td class="tg-0pky">4</td>
</tr>
<tr>
<td class="tg-0pky">Local variables should not shadow class fields</td>
<td class="tg-0pky">Overriding or shadowing a variable declared in an outer scope can strongly impact the readability, and therefore the maintainability, of a piece of <br /> code. Further, it could lead maintainers to introduce bugs because they think they&#39;re using one variable but are really using another. <br /> Noncompliant Code Example <br />  <br /> class Foo { <br />   public int myField; <br />  <br />   public void doSomething() { <br />     int myField = 0; <br />     ... <br />   } <br /> } <br />  <br /> See <br />  <br />    CERT, DCL01-C. - Do not reuse <br />   variable names in subscopes  <br />    CERT, DCL51-J. - Do <br />   not shadow or obscure identifiers in subscopes  <br /></td>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MAJOR</td>
<td class="tg-0pky">2</td>
</tr>
<tr>
<td class="tg-0pky">Methods should not have too many parameters</td>
<td class="tg-0pky">A long parameter list can indicate that a new structure should be created to wrap the numerous parameters or that the function is doing too many <br /> things. <br /> Noncompliant Code Example <br /> With a maximum number of 4 parameters: <br />  <br /> public void doSomething(int param1, int param2, int param3, String param4, long param5) { <br /> ... <br /> } <br />  <br /> Compliant Solution <br />  <br /> public void doSomething(int param1, int param2, int param3, String param4) { <br /> ... <br /> } <br />  <br /> Exceptions <br /> Methods annotated with Spring&#39;s @RequestMapping (and related shortcut annotations, like @GetRequest) or <br /> @JsonCreator may have a lot of parameters, encapsulation being possible. Such methods are therefore ignored.</td>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MAJOR</td>
<td class="tg-0pky">1</td>
</tr>
<tr>
<td class="tg-0pky">Unused &quot;private&quot; fields should be removed</td>
<td class="tg-0pky">If a private field is declared but not used in the program, it can be considered dead code and should therefore be removed. This will <br /> improve maintainability because developers will not wonder what the variable is used for. <br /> Note that this rule does not take reflection into account, which means that issues will be raised on private fields that are only <br /> accessed using the reflection API. <br /> Noncompliant Code Example <br />  <br /> public class MyClass { <br />   private int foo = 42; <br />  <br />   public int compute(int a) { <br />     return a <em> 42; <br />   } <br />  <br /> } <br />  <br /> Compliant Solution <br />  <br /> public class MyClass { <br />   public int compute(int a) { <br />     return a </em> 42; <br />   } <br /> } <br />  <br /> Exceptions <br /> The Java serialization runtime associates with each serializable class a version number, called serialVersionUID, which is used during <br /> deserialization to verify that the sender and receiver of a serialized object have loaded classes for that object that are compatible with respect to <br /> serialization. <br /> A serializable class can declare its own serialVersionUID explicitly by declaring a field named serialVersionUID that <br /> must be static, final, and of type long. By definition those serialVersionUID fields should not be reported by this rule: <br />  <br /> public class MyClass implements java.io.Serializable { <br />   private static final long serialVersionUID = 42L; <br /> } <br />  <br /> Moreover, this rule doesn&#39;t raise any issue on annotated fields.</td>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MAJOR</td>
<td class="tg-0pky">1</td>
</tr>
<tr>
<td class="tg-0pky">Unused method parameters should be removed</td>
<td class="tg-0pky">Unused parameters are misleading. Whatever the values passed to such parameters, the behavior will be the same. <br /> Noncompliant Code Example <br />  <br /> void doSomething(int a, int b) {     // &quot;b&quot; is unused <br />   compute(a); <br /> } <br />  <br /> Compliant Solution <br />  <br /> void doSomething(int a) { <br />   compute(a); <br /> } <br />  <br /> Exceptions <br /> The rule will not raise issues for unused parameters: <br />  <br />    that are annotated with @javax.enterprise.event.Observes  <br />    in overrides and implementation methods  <br />    in interface default methods  <br />    in non-private methods that only throw or that have empty bodies  <br />    in annotated methods, unless the annotation is @SuppressWarning(&quot;unchecked&quot;) or @SuppressWarning(&quot;rawtypes&quot;), in <br />   which case the annotation will be ignored  <br />    in overridable methods (non-final, or not member of a final class, non-static, non-private), if the parameter is documented with a proper <br />   javadoc.  <br />  <br />  <br /> @Override <br /> void doSomething(int a, int b) {     // no issue reported on b <br />   compute(a); <br /> } <br />  <br /> public void foo(String s) { <br />   // designed to be extended but noop in standard case <br /> } <br />  <br /> protected void bar(String s) { <br />   //open-closed principle <br /> } <br />  <br /> public void qix(String s) { <br />   throw new UnsupportedOperationException(&quot;This method should be implemented in subclasses&quot;); <br /> } <br />  <br /> /<em>* <br />  </em> @param s This string may be use for further computation in overriding classes <br />  */ <br /> protected void foobar(int a, String s) { // no issue, method is overridable and unused parameter has proper javadoc <br />   compute(a); <br /> } <br />  <br /> See <br />  <br />    MISRA C++:2008, 0-1-11 - There shall be no unused parameters (named or unnamed) in nonvirtual functions.  <br />    MISRA C:2012, 2.7 - There should be no unused parameters in functions  <br />    CERT, MSC12-C. - Detect and remove code that has no effect or is never <br />   executed  <br /></td>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MAJOR</td>
<td class="tg-0pky">1</td>
</tr>
<tr>
<td class="tg-0pky">Throwable and Error should not be caught</td>
<td class="tg-0pky">Throwable is the superclass of all errors and exceptions in Java. Error is the superclass of all errors, which are not <br /> meant to be caught by applications. <br /> Catching either Throwable or Error will also catch OutOfMemoryError and InternalError, from <br /> which an application should not attempt to recover. <br /> Noncompliant Code Example <br />  <br /> try { /<em> ... </em>/ } catch (Throwable t) { /<em> ... </em>/ } <br /> try { /<em> ... </em>/ } catch (Error e) { /<em> ... </em>/ } <br />  <br /> Compliant Solution <br />  <br /> try { /<em> ... </em>/ } catch (RuntimeException e) { /<em> ... </em>/ } <br /> try { /<em> ... </em>/ } catch (MyException e) { /<em> ... </em>/ } <br />  <br /> See <br />  <br />    MITRE, CWE-396 - Declaration of Catch for Generic Exception  <br />    CERT, ERR08-J. - Do not catch NullPointerException or any of its ancestors <br />    <br /></td>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MAJOR</td>
<td class="tg-0pky">2</td>
</tr>
<tr>
<td class="tg-0pky">Dead stores should be removed</td>
<td class="tg-0pky">A dead store happens when a local variable is assigned a value that is not read by any subsequent instruction. Calculating or retrieving a value <br /> only to then overwrite it or throw it away, could indicate a serious error in the code. Even if it&#39;s not an error, it is at best a waste of resources. <br /> Therefore all calculated values should be used. <br /> Noncompliant Code Example <br />  <br /> i = a + b; // Noncompliant; calculation result not used before value is overwritten <br /> i = compute(); <br />  <br /> Compliant Solution <br />  <br /> i = a + b; <br /> i += compute(); <br />  <br /> Exceptions <br /> This rule ignores initializations to -1, 0, 1, null, true, false and &quot;&quot;. <br /> See <br />  <br />    MITRE, CWE-563 - Assignment to Variable without Use (&#39;Unused Variable&#39;)  <br />    CERT, MSC13-C. - Detect and remove unused values  <br />    CERT, MSC56-J. - Detect and remove superfluous code and values  <br /></td>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MAJOR</td>
<td class="tg-0pky">2</td>
</tr>
<tr>
<td class="tg-0pky">Modifiers should be declared in the correct order</td>
<td class="tg-0pky">The Java Language Specification recommends listing modifiers in the following order: <br /> 1. Annotations <br /> 2. public <br /> 3. protected <br /> 4. private <br /> 5. abstract <br /> 6. static <br /> 7. final <br /> 8. transient <br /> 9. volatile <br /> 10. synchronized <br /> 11. native <br /> 12. strictfp <br /> Not following this convention has no technical impact, but will reduce the code&#39;s readability because most developers are used to the standard <br /> order. <br /> Noncompliant Code Example <br />  <br /> static public void main(String[] args) {   // Noncompliant <br /> } <br />  <br /> Compliant Solution <br />  <br /> public static void main(String[] args) {   // Compliant <br /> } <br /></td>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MINOR</td>
<td class="tg-0pky">1</td>
</tr>
<tr>
<td class="tg-0pky">&quot;switch&quot; statements should have at least 3 &quot;case&quot; clauses</td>
<td class="tg-0pky">switch statements are useful when there are many different cases depending on the value of the same expression. <br /> For just one or two cases however, the code will be more readable with if statements. <br /> Noncompliant Code Example <br />  <br /> switch (variable) { <br />   case 0: <br />     doSomething(); <br />     break; <br />   default: <br />     doSomethingElse(); <br />     break; <br /> } <br />  <br /> Compliant Solution <br />  <br /> if (variable == 0) { <br />   doSomething(); <br /> } else { <br />   doSomethingElse(); <br /> } <br />  <br /> See <br />  <br />    MISRA C:2012, 16.6 - Every switch statement shall have at least two switch-clauses  <br /></td>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MINOR</td>
<td class="tg-0pky">2</td>
</tr>
<tr>
<td class="tg-0pky">Unused local variables should be removed</td>
<td class="tg-0pky">If a local variable is declared but not used, it is dead code and should be removed. Doing so will improve maintainability because developers will <br /> not wonder what the variable is used for. <br /> Noncompliant Code Example <br />  <br /> public int numberOfMinutes(int hours) { <br />   int seconds = 0;   // seconds is never used <br />   return hours <em> 60; <br /> } <br />  <br /> Compliant Solution <br />  <br /> public int numberOfMinutes(int hours) { <br />   return hours </em> 60; <br /> } <br /></td>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MINOR</td>
<td class="tg-0pky">2</td>
</tr>
<tr>
<td class="tg-0pky">Catches should be combined</td>
<td class="tg-0pky">Since Java 7 it has been possible to catch multiple exceptions at once. Therefore, when multiple catch blocks have the same code, they <br /> should be combined for better readability. <br /> Note that this rule is automatically disabled when the project&#39;s sonar.java.source is lower than 7. <br /> Noncompliant Code Example <br />  <br /> catch (IOException e) { <br />   doCleanup(); <br />   logger.log(e); <br /> } <br /> catch (SQLException e) {  // Noncompliant <br />   doCleanup(); <br />   logger.log(e); <br /> } <br /> catch (TimeoutException e) {  // Compliant; block contents are different <br />   doCleanup(); <br />   throw e; <br /> } <br />  <br /> Compliant Solution <br />  <br /> catch (IOException&amp;#124SQLException e) { <br />   doCleanup(); <br />   logger.log(e); <br /> } <br /> catch (TimeoutException e) { <br />   doCleanup(); <br />   throw e; <br /> } <br /></td>
<td class="tg-0pky">CODE_SMELL</td>
<td class="tg-0pky">MINOR</td>
<td class="tg-0pky">1</td>
</tr>
<tr>
<td class="tg-0pky">Using command line arguments is security-sensitive</td>
<td class="tg-0pky">Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities: <br />  <br />    CVE-2018-7281  <br />    CVE-2018-12326  <br />    CVE-2011-3198  <br />  <br /> Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized. <br /> Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus <br /> passing sensitive information via command line arguments should be considered as insecure. <br /> This rule raises an issue when on every program entry points (main methods) when command line arguments are used. The goal is to guide <br /> security code reviews. <br /> Ask Yourself Whether <br />  <br />    any of the command line arguments are used without being sanitized first.  <br />    your application accepts sensitive information via command line arguments.  <br />  <br /> If you answered yes to any of these questions you are at risk. <br /> Recommended Secure Coding Practices <br /> Sanitize all command line arguments before using them. <br /> Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing <br /> sensitive information to an application than exposing them in the command line. It is common to write them on the process&#39; standard input, or give the <br /> path to a file containing the information. <br /> Sensitive Code Example <br /> This rule raises an issue as soon as there is a reference to argv, be it for direct use or via a CLI library like JCommander, GetOpt or Apache <br /> CLI. <br />  <br /> public class Main { <br /> &nbsp;&nbsp;&nbsp; public static void main (String[] argv) { <br /> &nbsp; &nbsp; &nbsp; &nbsp; String option = argv[0]; &nbsp;// Questionable: check how the argument is used <br /> &nbsp;&nbsp;&nbsp; } <br /> } <br />  <br />  <br /> // === JCommander === <br /> import&nbsp;com.beust.jcommander.<em>; <br />  <br /> public class Main { <br /> &nbsp;&nbsp;&nbsp; public static void main (String[] argv) { <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Main main = new Main(); <br /> &nbsp; &nbsp; &nbsp; &nbsp; JCommander.newBuilder() <br /> &nbsp; &nbsp; &nbsp; &nbsp; .addObject(main) <br /> &nbsp; &nbsp; &nbsp; &nbsp; .build() <br /> &nbsp; &nbsp; &nbsp; &nbsp; .parse(argv); // Questionable <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;main.run(); <br /> &nbsp;&nbsp; &nbsp;} <br /> } <br />  <br />  <br /> // === GNU Getopt === <br /> import gnu.getopt.Getopt; <br />  <br /> public class Main { <br /> &nbsp;&nbsp;&nbsp; public static void main (String[] argv) { <br /> &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Getopt g = new Getopt(&quot;myprog&quot;, argv, &quot;ab&quot;); // Questionable <br /> &nbsp;&nbsp;&nbsp; } <br /> } <br />  <br />  <br /> // === Apache CLI === <br /> import org.apache.commons.cli.</em>; <br />  <br /> public class Main { <br /> &nbsp;&nbsp;&nbsp; public static void main (String[] argv) { <br /> &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Options options = new Options(); <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; CommandLineParser parser = new DefaultParser(); <br /> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;try { <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  CommandLine line = parser.parse(options, argv); // Questionable <br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; } <br /> &nbsp;&nbsp;&nbsp; } <br /> } <br />  <br /> In the case of Args4J, an issue is created on the public void run method of any class using org.kohsuke.args4j.Option or <br /> org.kohsuke.args4j.Argument. <br /> Such a class is called directly by org.kohsuke.args4j.Starter outside of any public static void main method. If the class <br /> has no run method, no issue will be raised as there must be a public static void main and its argument is already <br /> highlighted. <br />  <br /> // === argv4J === <br /> import org.kohsuke.args4j.Option; <br /> import org.kohsuke.args4j.Argument; <br />  <br /> public class Main { <br />     @Option(name=&quot;-myopt&quot;,usage=&quot;An option&quot;) <br />     public String myopt; <br />  <br />     @Argument(usage = &quot;An argument&quot;, metaVar = &quot;&lt;myArg&gt;&quot;) <br />     String myarg; <br />  <br />     String file; <br />  <br />     @Option(name=&quot;-file&quot;) <br />     public void setFile(String file) { <br />         this.file = file; <br />     } <br />  <br />     String arg2; <br />  <br />     @Argument(index=1) <br />     public void setArg2(String arg2) { <br />         this.arg2 = arg2; <br />     } <br />  <br /> &nbsp;&nbsp; &nbsp;public void run() { // Questionable: This function <br />         myarg; // check how this argument is used <br /> &nbsp;&nbsp; &nbsp;} <br /> } <br />  <br /> Exceptions <br /> The support of Argv4J without the use of org.kohsuke.argv4j.Option is out of scope as there is no way to know which Bean will be used <br /> as the mainclass. <br /> No issue will be raised on public static void main(String[] argv) if argv is not referenced in the method. <br /> See <br />  <br />    OWASP Top 10 2017 Category A1 - Injection  <br />    MITRE, CWE-88 - Argument Injection or Modification  <br />    MITRE, CWE-214 - Information Exposure Through Process Environment  <br />    SANS Top 25 - Insecure Interaction Between Components  <br /></td>
<td class="tg-0pky">SECURITY_HOTSPOT</td>
<td class="tg-0pky">CRITICAL</td>
<td class="tg-0pky">5</td>
</tr>
</tbody>
</table>


    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2019 <a href="http://www.waarp.fr">Waarp</a>.
All rights reserved.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
